@import url('https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500&display=swap');
@import "tailwindcss";

:root {
  --white:       #ffffff;
  --off:         #f9f9f8;
  --surface:     #f3f3f1;
  --border:      #e5e5e3;
  --border-dark: #c8c8c5;
  --ink:         #1a1a18;
  --ink-mid:     #6b6b68;
  --ink-light:   #a8a8a5;
  --serif:       'DM Serif Display', Georgia, serif;
  --sans:        'DM Sans', system-ui, sans-serif;
  --nav-height:  65px;
}

@theme inline {
  --font-serif: var(--serif);
  --font-sans:  var(--sans);
}

*, *::before, *::after { box-sizing: border-box; }

html, body {
  height: 100%;
  background: var(--off);
  color: var(--ink);
  font-family: var(--sans);
  -webkit-font-smoothing: antialiased;
}

/* ── Nav ───────────────────────────────────────────── */
.nav {
  display: flex; align-items: center; justify-content: space-between;
  padding: 1.25rem 2rem;
  border-bottom: 1px solid var(--border);
  background: var(--white);
  position: sticky; top: 0; z-index: 40;
}
.nav-logo {
  font-family: var(--serif); font-size: 1.3rem; color: var(--ink);
  text-decoration: none; letter-spacing: -0.2px;
}
.nav-logo em { font-style: italic; color: var(--ink-light); }
.nav-right { display: flex; align-items: center; gap: 0.75rem; }
.nav-link { font-size: 0.82rem; color: var(--ink-mid); text-decoration: none; }
.nav-link:hover { color: var(--ink); }
.nav-avatar {
  width: 30px; height: 30px; border-radius: 50%;
  background: var(--surface); border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--serif); font-size: 0.7rem; color: var(--ink-mid);
  text-decoration: none; overflow: hidden; transition: border-color 0.15s;
}
.nav-avatar:hover { border-color: var(--border-dark); }
.nav-avatar img { width: 100%; height: 100%; object-fit: cover; }

/* ── Buttons ───────────────────────────────────────── */
.btn-primary {
  display: inline-flex; align-items: center; gap: 0.35rem;
  font-family: var(--sans); font-size: 0.82rem; font-weight: 500;
  padding: 0.5rem 1rem; border-radius: 6px; border: none; cursor: pointer;
  background: var(--ink); color: var(--white);
  text-decoration: none; transition: background 0.15s;
}
.btn-primary:hover { background: #3a3a38; }

/* ── Homepage ──────────────────────────────────────── */
.home { max-width: 960px; margin: 0 auto; padding: 0 2rem 5rem; }

.hero {
  display: flex; flex-direction: column; align-items: center;
  text-align: center; padding: 5rem 1rem 3.5rem;
  border-bottom: 1px solid var(--border);
}
.hero-title {
  font-family: var(--serif); font-size: clamp(2.2rem, 5vw, 3.5rem);
  font-weight: 400; line-height: 1.15; color: var(--ink); margin-bottom: 1rem;
}
.hero-title em { font-style: italic; color: var(--ink-mid); }
.hero-sub { font-size: 1rem; color: var(--ink-mid); max-width: 380px; line-height: 1.65; margin-bottom: 2rem; }
.hero-cta { font-size: 0.88rem; padding: 0.65rem 1.4rem; }

.families-section { padding-top: 3rem; }
.section-title {
  font-family: var(--serif); font-size: 1.1rem; font-weight: 400;
  color: var(--ink); margin-bottom: 1.5rem;
}
.families-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
}
.family-card {
  background: var(--white); border: 1px solid var(--border); border-radius: 10px;
  padding: 1.25rem; text-decoration: none; color: var(--ink);
  transition: border-color 0.15s, box-shadow 0.15s, transform 0.15s;
}
.family-card:hover { border-color: var(--border-dark); box-shadow: 0 3px 14px rgba(0,0,0,0.055); transform: translateY(-2px); }
.family-card-glyph { font-size: 1.5rem; margin-bottom: 0.6rem; }
.family-card-name { font-family: var(--serif); font-size: 1rem; margin-bottom: 0.25rem; }
.family-card-desc { font-size: 0.75rem; color: var(--ink-light); line-height: 1.5; }
.empty-families { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; padding: 3rem; color: var(--ink-light); font-size: 0.88rem; }
.empty-families a { color: var(--ink); }

/* ── Auth pages ────────────────────────────────────── */
.auth-page {
  display: flex; align-items: center; justify-content: center;
  min-height: calc(100vh - 65px); padding: 2rem;
}
.auth-card {
  background: var(--white); border: 1px solid var(--border);
  border-radius: 14px; padding: 2rem;
  width: 100%; max-width: 380px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.06);
}
.auth-title {
  font-family: var(--serif); font-size: 1.5rem; font-weight: 400;
  color: var(--ink); margin-bottom: 0.25rem;
}
.auth-sub { font-size: 0.82rem; color: var(--ink-light); margin-bottom: 1.75rem; }

/* ── Form inputs ───────────────────────────────────── */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="number"] {
  width: 100%; padding: 0.55rem 0.75rem;
  border: 1px solid var(--border); border-radius: 7px;
  font-family: var(--sans); font-size: 0.86rem; color: var(--ink);
  background: var(--white); outline: none;
  transition: border-color 0.15s;
}
input::placeholder { color: var(--ink-light); }
input:focus { border-color: var(--ink); }

/* ── Dashboard ─────────────────────────────────────── */
.dashboard-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  padding: 3rem 0 2rem; gap: 1rem; flex-wrap: wrap;
}
.dashboard-title { font-family: var(--serif); font-size: 1.8rem; font-weight: 400; }
.create-family-form {
  display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;
  background: var(--white); border: 1px solid var(--border);
  border-radius: 10px; padding: 0.75rem; max-width: 480px;
}
.create-family-form input { min-width: 180px; }
.btn-ghost {
  display: inline-flex; align-items: center;
  font-family: var(--sans); font-size: 0.82rem; font-weight: 500;
  padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;
  background: transparent; color: var(--ink-mid);
  border: 1px solid var(--border); text-decoration: none;
  transition: all 0.15s;
}
.btn-ghost:hover { background: var(--surface); color: var(--ink); border-color: var(--border-dark); }
.btn-danger {
  display: inline-flex; align-items: center;
  font-family: var(--sans); font-size: 0.82rem; font-weight: 500;
  padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;
  background: transparent; color: #b03030; border: 1px solid #f0cece;
  transition: all 0.15s;
}
.btn-danger:hover { background: #fdf3f3; }

/* ── Tree page ─────────────────────────────────────── */
.tree-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 1.25rem 2rem; border-bottom: 1px solid var(--border);
  background: var(--white); position: sticky; top: 0; z-index: 40; gap: 1rem;
}
.tree-title { font-family: var(--serif); font-size: 1.2rem; font-weight: 400; display: flex; align-items: center; gap: 0.4rem; }
.tree-desc { font-size: 0.75rem; color: var(--ink-light); margin-top: 0.1rem; }
.tree-edit-btn {
  background: none; border: none; cursor: pointer; padding: 0 0.2rem;
  font-size: 0.85rem; color: var(--ink-light); line-height: 1; transition: color 0.15s;
}
.tree-edit-btn:hover { color: var(--ink); }
.member-count { font-size: 0.72rem; color: var(--ink-light); }

.tree-page { display: flex; flex-direction: column; height: calc(100dvh - var(--nav-height)); overflow: hidden; }
.self-banner {
  padding: 0.55rem 2rem; background: #fdf6ec; border-bottom: 1px solid #e8d9b8;
  font-size: 0.8rem; color: #6b5120;
}
.self-banner-btn {
  background: none; border: none; padding: 0; cursor: pointer;
  color: #8a6f3e; font-weight: 600; text-decoration: underline; font-size: inherit;
}
.canvas-wrap { flex: 1; overflow: auto; background: var(--white); }
.tree-canvas { position: relative; min-width: max-content; padding: 4rem 4rem 7rem; }
.svg-lines { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 0; overflow: visible; }

.gen-row { display: flex; justify-content: center; gap: 1.25rem; position: relative; z-index: 1; }
.gen-row + .gen-row { margin-top: 4.5rem; }

/* ── Cards ─────────────────────────────────────────── */
.card {
  width: 148px; background: var(--white); border: 1px solid var(--border);
  border-radius: 10px; padding: 1.1rem 0.85rem 0.9rem;
  text-align: center; cursor: pointer; position: relative; z-index: 1;
  transition: border-color 0.15s, box-shadow 0.15s, transform 0.15s;
  animation: cardIn 0.3s ease both;
}
.card:hover { border-color: var(--border-dark); box-shadow: 0 3px 14px rgba(0,0,0,0.055); transform: translateY(-2px); }
.card.selected { border-color: var(--ink); box-shadow: 0 0 0 3px rgba(26,26,24,0.06); }
.card.card--self { border-color: #8a6f3e; box-shadow: 0 0 0 3px rgba(138,111,62,0.12); position: relative; }
.card-self-badge {
  position: absolute; top: -8px; right: 8px;
  font-size: 0.58rem; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase;
  background: #8a6f3e; color: #fff; border-radius: 20px; padding: 2px 7px;
}
@keyframes cardIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }

.avatar {
  width: 50px; height: 50px; border-radius: 50%;
  margin: 0 auto 0.75rem; display: flex; align-items: center; justify-content: center;
  font-family: var(--serif); font-size: 1rem;
  background: var(--surface); color: var(--ink-mid);
  border: 1px solid var(--border); overflow: hidden;
}
.avatar img { width: 100%; height: 100%; object-fit: cover; }
.card-name { font-family: var(--serif); font-size: 0.88rem; color: var(--ink); line-height: 1.25; margin-bottom: 0.25rem; }
.card-meta { font-size: 0.67rem; color: var(--ink-light); line-height: 1.5; }
.card-tag {
  display: inline-block; margin-top: 0.45rem;
  font-size: 0.6rem; letter-spacing: 0.6px; text-transform: uppercase;
  color: var(--ink-light); border: 1px solid var(--border);
  border-radius: 50px; padding: 0.12rem 0.5rem; font-weight: 500;
}

/* ── Empty state ───────────────────────────────────── */
.empty {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  min-height: 55vh; gap: 0.6rem; text-align: center; padding: 2rem;
}
.empty-glyph { font-size: 2.2rem; opacity: 0.2; margin-bottom: 0.4rem; }
.empty h2 { font-family: var(--serif); font-size: 1.5rem; font-weight: 400; }
.empty p { font-size: 0.85rem; color: var(--ink-light); max-width: 260px; line-height: 1.65; }

/* ── Tray ──────────────────────────────────────────── */
.tray {
  position: fixed; bottom: 1.5rem; left: 50%;
  transform: translateX(-50%) translateY(16px);
  z-index: 50; background: var(--white); border: 1px solid var(--border);
  border-radius: 12px; padding: 0.65rem 0.85rem;
  display: flex; align-items: center; gap: 0.75rem;
  box-shadow: 0 4px 28px rgba(0,0,0,0.09), 0 1px 3px rgba(0,0,0,0.04);
  opacity: 0; pointer-events: none;
  transition: opacity 0.2s, transform 0.2s;
  width: calc(100vw - 3rem); max-width: 580px;
}
.tray.open { opacity: 1; pointer-events: all; transform: translateX(-50%) translateY(0); }
.tray-av {
  width: 34px; height: 34px; border-radius: 50%; flex-shrink: 0;
  background: var(--surface); border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--serif); font-size: 0.82rem; color: var(--ink-mid); overflow: hidden;
}
.tray-av img { width: 100%; height: 100%; object-fit: cover; }
.tray-info { flex: 1; min-width: 0; overflow: hidden; }
.tray-name { font-family: var(--serif); font-size: 0.88rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.tray-meta { font-size: 0.67rem; color: var(--ink-light); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.tray-btns { display: flex; gap: 0.3rem; flex-shrink: 0; align-items: center; }
.tray-btns .btn-ghost,
.tray-btns .btn-primary { font-size: 0.75rem; padding: 0.3rem 0.65rem; }
.tray-rel-btn { color: var(--ink-mid); }

/* ── Modal ─────────────────────────────────────────── */
.overlay {
  display: none; position: fixed; inset: 0; z-index: 100;
  background: rgba(249,249,248,0.88); backdrop-filter: blur(6px);
  align-items: center; justify-content: center; padding: 1.5rem;
}
.overlay.open { display: flex; }
.modal {
  background: var(--white); border: 1px solid var(--border);
  border-radius: 14px; padding: 1.75rem;
  width: 100%; max-width: 390px;
  box-shadow: 0 12px 45px rgba(0,0,0,0.09);
  animation: mIn 0.2s ease;
}
@keyframes mIn { from { opacity:0; transform:scale(0.97) translateY(6px); } to { opacity:1; transform:none; } }
.modal-hd { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.35rem; }
.modal-hd h2 { font-family: var(--serif); font-size: 1.2rem; font-weight: 400; }
.modal-x { background: none; border: none; font-size: 0.85rem; cursor: pointer; color: var(--ink-light); width: 26px; height: 26px; border-radius: 5px; display: flex; align-items: center; justify-content: center; transition: all 0.15s; }
.modal-x:hover { background: var(--surface); color: var(--ink); }
.photo-wrap { display: flex; flex-direction: column; align-items: center; margin-bottom: 1.25rem; gap: 0.35rem; }
.photo-circle { width: 66px; height: 66px; border-radius: 50%; border: 1px solid var(--border); background: var(--surface); display: flex; align-items: center; justify-content: center; font-family: var(--serif); font-size: 1.35rem; color: var(--ink-mid); cursor: pointer; overflow: hidden; transition: border-color 0.15s; }
.photo-circle:hover { border-color: var(--border-dark); }
.photo-hint { font-size: 0.67rem; color: var(--ink-light); }
.field { margin-bottom: 0.85rem; }
.field label { display: block; font-size: 0.68rem; font-weight: 500; letter-spacing: 0.5px; text-transform: uppercase; color: var(--ink-light); margin-bottom: 0.3rem; }
.field select { width: 100%; padding: 0.55rem 0.75rem; border: 1px solid var(--border); border-radius: 7px; font-family: var(--sans); font-size: 0.86rem; color: var(--ink); background: var(--white); outline: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='11' viewBox='0 0 24 24' fill='none' stroke='%23a8a8a5' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.7rem center; padding-right: 1.8rem; }
.field select:focus { border-color: var(--ink); }
.field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.65rem; }
.modal-ft { display: flex; justify-content: space-between; align-items: center; margin-top: 1.25rem; padding-top: 1.1rem; border-top: 1px solid var(--border); }
